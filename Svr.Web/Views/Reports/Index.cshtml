@model Svr.Web.Models.ReportsViewModels.IndexViewModel
@{
    ViewData["Title"] = "Список отчетов";
}

<h4>@ViewData["Title"]</h4>

@await Html.PartialAsync("_StatusMessage", Model.StatusMessage)

<div class="form-group form-inline">
    <div>
        <form asp-action="InMemoryReport" method="post">
            @Html.Hidden("dateS", Model.FilterViewModel.DateS)
            @Html.Hidden("datePo", Model.FilterViewModel.DatePo)
            @Html.Hidden("lord", Model.FilterViewModel.SelectedLord)
            @Html.Hidden("owner", Model.FilterViewModel.SelectedOwner)
            @Html.Hidden("category", Model.FilterViewModel.SelectedCategory)
            <input type="submit" value="Создание отчета в памяти" class="btn btn-sm btn-primary" />
        </form>
    </div>
    @*<div>
        <form asp-action="FileReport" method="post">
            @Html.Hidden("dateS", Model.FilterViewModel.DateS)
            @Html.Hidden("datePo", Model.FilterViewModel.DatePo)
            @Html.Hidden("lord", Model.FilterViewModel.SelectedLord)
            @Html.Hidden("owner", Model.FilterViewModel.SelectedOwner)
            @Html.Hidden("category", Model.FilterViewModel.SelectedCategory)
            <input type="submit" value="Создать файл отчета" class="btn btn-sm btn-primary" />
        </form>
    </div>*@
</div>


@await Html.PartialAsync("List", Model)

@*@section Scripts {
        @await Html.PartialAsync("_ValidationScriptsPartial")
    }*@


@*<fieldset style="margin-top: 15px">
       <legend>Upload an xlsx file</legend>
       <form method="post"
             asp-action="FileUpload"
             asp-controller="Home"
             enctype="multipart/form-data">
          <input type="file" name="file"  />
          <input type="submit" value="Upload" />
       </form>
    </fieldset>*@
@*<fieldset style="margin-top: 15px">
       <legend>Handling Blob Responses</legend>
       <button type="button" onclick="downloadBlob()">Ajax Download</button>
    </fieldset>*@
@*@section Scripts
    {
        <script type="text/javascript">
        function downloadBlob()
        {
            fetch('/Reports/InMemoryReport')
             .then(function(response) {
                 return response.blob();
             })
             .then(function(xlsxBlob) {
                 var a = document.createElement("a");
                 document.body.appendChild(a);
                 a.style = "display: none";
                 let url = window.URL.createObjectURL(xlsxBlob);
                 a.href = url;
                 a.download = "report.xlsx";
                 a.click();
                 window.URL.revokeObjectURL(url);
             });
        }
        </script>
    }*@